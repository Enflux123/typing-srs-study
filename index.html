<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Typing Study App</title>
  <style>
    body { font-family: sans-serif; background:#f7f7f7; padding:20px; }
    #app { max-width:650px; margin:auto; text-align:center; }
    .card { background:white; padding:20px; margin:20px 0; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .hidden { display:none; }
    button { margin:5px; padding:10px 20px; border:none; border-radius:8px; cursor:pointer; }
    .correct { background:#4caf50; color:white; }
    .wrong { background:#f44336; color:white; }
    textarea { width:100%; height:120px; padding:10px; }
    #nextReview { margin-top:10px; font-size:0.9em; color:#555; }
  </style>
</head>
<body>
<div id="app">
  <h1>Typing Study App</h1>

  <!-- Card input -->
  <div class="card">
    <input id="frontInput" placeholder="Front (term)">
    <input id="backInput" placeholder="Back (definition)">
    <button onclick="addCard()">Add Card</button>
    <h3>Import Cards</h3>
    <textarea id="importBox" placeholder="Paste cards here: Term | Definition"></textarea>
    <button onclick="importCards()">Import</button>
  </div>

  <!-- Study area -->
  <div id="studyArea" class="card hidden">
    <div id="frontText"></div>
    <form id="answerForm">
      <input id="answerBox" autocomplete="off" placeholder="Type your answer..." style="width:100%;padding:10px;">
    </form>
    <div id="backArea" class="hidden">
      <p id="backText"></p>
      <button class="correct" type="button" onclick="markCorrect()">Correct</button>
      <button class="wrong" type="button" onclick="markWrong()">Wrong</button>
      <div id="nextReview"></div>
    </div>
  </div>

  <button id="startBtn" onclick="startSession()">Start Session</button>

  <h3>Cards</h3>
  <ul id="cardList"></ul>
</div>

<script>
let cards = [];
let queue = [];
let current = null;
let tries = 0;

// Intervals (ms)
const intervals = {
  1: 24*60*60*1000,  // 1 day
  2: 10*60*1000,     // 10 minutes
  3: 6*60*1000,      // 6 minutes
  default: 1*60*1000 // 1 minute
};

// Human-readable
function intervalLabel(ms) {
  if(ms >= 24*60*60*1000) return (ms/(24*60*60*1000))+"d";
  if(ms >= 60*60*1000) return (ms/(60*60*1000))+"h";
  if(ms >= 60*1000) return (ms/(60*1000))+"m";
  return (ms/1000)+"s";
}

// Add card
function addCard(){
  const front = document.getElementById("frontInput").value.trim();
  const back = document.getElementById("backInput").value.trim();
  if(!front || !back) return;
  cards.push({front, back, due: Date.now()});
  document.getElementById("frontInput").value="";
  document.getElementById("backInput").value="";
  renderCardList();
}

// Import cards
function importCards(){
  const lines = document.getElementById("importBox").value.trim().split("\n");
  lines.forEach(line=>{
    const parts=line.split("|");
    if(parts.length===2){
      const front=parts[0].trim(), back=parts[1].trim();
      if(front && back){
        cards.push({front, back, due: Date.now()});
      }
    }
  });
  document.getElementById("importBox").value="";
  renderCardList();
}

function renderCardList(){
  const ul = document.getElementById("cardList");
  ul.innerHTML="";
  cards.forEach(c=>{
    const li=document.createElement("li");
    li.textContent=`${c.front} â†’ ${c.back}`;
    ul.appendChild(li);
  });
}

// Start session
function startSession(){
  queue = cards.filter(c=>c.due <= Date.now());
  if(queue.length===0){ alert("No cards due!"); return; }
  document.getElementById("studyArea").classList.remove("hidden");
  nextCard();
}

// Next card
function nextCard(){
  if(queue.length===0){
    alert("Session complete!");
    document.getElementById("studyArea").classList.add("hidden");
    return;
  }
  current = queue.shift();
  tries = 0;
  document.getElementById("frontText").textContent = current.front;
  document.getElementById("answerBox").value="";
  document.getElementById("backArea").classList.add("hidden");
  document.getElementById("nextReview").textContent="";
  document.getElementById("answerBox").focus();
}

// Submit answer
document.getElementById("answerForm").addEventListener("submit", function(e){
  e.preventDefault();
  tries++;
  document.getElementById("backText").textContent = current.back;
  document.getElementById("backArea").classList.remove("hidden");
});

// Mark Correct
function markCorrect(){
  // Choose interval based on tries
  let interval = intervals[tries] || intervals.default;
  current.due = Date.now() + interval;
  document.getElementById("nextReview").textContent = "Next review: " + intervalLabel(interval);
  // Delay so user can see next review time
  setTimeout(nextCard, 1200);
}

// Mark Wrong
function markWrong(){
  document.getElementById("backArea").classList.add("hidden");
  document.getElementById("answerBox").value="";
  document.getElementById("answerBox").focus();
}
</script>
</body>
</html>
